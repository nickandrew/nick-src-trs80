*GET	DOSCALLS

	ORG	8000H
START	CALL	01C9H
	DI
INCR	LD	HL,BUFFER
	INC	(HL)
	LD	A,(HL)
	CP	27
	JR	NZ,A2
	LD	(HL),1
	INC	HL
A1	INC	(HL)
	LD	A,(HL)
	CP	37
	JR	NZ,A2
	LD	(HL),1
	INC	HL
	JR	A1
A2	LD	DE,BUFF2
	LD	HL,BUFFER
	EX	DE,HL
	LD	B,8
A3	LD	A,(DE)
	CP	0
	JR	NZ,A4
	LD	(HL),32
	JR	A6
A4	CP	27
	JR	NC,A5
	ADD	A,64
	LD	(HL),A
	JR	A6
A5	ADD	A,21
	LD	(HL),A
A6	INC	HL
	INC	DE
	DJNZ	A3
	LD	HL,BUFF2
	LD	DE,15360
	LD	BC,8
	LDIR
	; HASH PASSWORD HERE
	LD	HL,0FFFFH
	LD	DE,BUFF2
	LD	B,8
	LD	A,E
	ADD	A,7
	LD	E,A
	JR	NZ,B1
	INC	D
B1	LD	A,(DE)
	PUSH	DE
	LD	D,A
	LD	E,H
	LD	A,L
	AND	7
	RRCA
	RRCA
	RRCA
	XOR	L
	LD	L,A
	LD	H,0
	ADD	HL,HL
	ADD	HL,HL
	ADD	HL,HL
	ADD	HL,HL
	XOR	H
	XOR	D
	LD	D,A
	LD	A,L
	ADD	HL,HL
	XOR	H
	XOR	E
	LD	E,A
	EX	DE,HL
	POP	DE
	DEC	DE
	DJNZ	B1
	LD	A,L
	CP	0A2H
	JR	NZ,INCR
	LD	A,H
	CP	61H
	JR	NZ,INCR
A8	LD	HL,BUFF2
	LD	B,8
A9	LD	A,(HL)
	INC	HL
	CALL	ROM@PUT_VDU
	DJNZ	A9
	JP	INCR
BUFFER	DEFW	0
	DEFW	0
	DEFW	0
	DEFW	0
BUFF2	DEFS	8
MESS	DEFM	'FOLLOWING PASSWORD WORKS: '
	DEFB	0DH
	END	START
